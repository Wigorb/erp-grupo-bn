name: Project Cards Automation

on:
  workflow_dispatch:

jobs:
  add-cards:
    runs-on: ubuntu-latest

    steps:
      - name: Criar cards no GitHub Projects
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GH_TOKEN }}
          script: |
            const cards = [
              "Finalizar configuraÃ§Ã£o de domÃ­nio no Registro.br",
              "Apontar DNS para Vercel (ns1/ns2.vercel-dns.com)",
              "Verificar propagaÃ§Ã£o total do domÃ­nio",
              "Ajustar favicon e tÃ­tulo do painel ERP",
              "Atualizar tÃ­tulo da aba e Ã­cone no layout",
              "Concluir estilizaÃ§Ã£o da mandala de mÃ³dulos",
              "Aplicar cores e Ã­cones definitivos",
              "Adicionar efeitos (hover, som, animaÃ§Ã£o leve)",
              "Criar cards visuais dos mÃ³dulos ERP na tela principal",
              "Vendas, Compras, PCP, ExpediÃ§Ã£o, Fiscal, Financeiro etc",
              "Criar tela de login com autenticaÃ§Ã£o JWT",
              "Backend Django + DRF",
              "Frontend com validaÃ§Ã£o e roteamento"
            ];

            const owner = "Wigorb";
            const projectNumber = 1;

            const { data: projects } = await github.rest.projects.listForUser({ username: owner });
            const project = projects.find(p => p.number === projectNumber);
            const columns = await github.rest.projects.listColumns({ project_id: project.id });
            const backlog = columns.data.find(c => c.name.toLowerCase().includes("pendÃªncia") || c.name.toLowerCase().includes("backlog"));

            for (const card of cards) {
              await github.rest.projects.createCard({
                column_id: backlog.id,
                note: `ðŸ“Œ ${card}`
              });
            }
